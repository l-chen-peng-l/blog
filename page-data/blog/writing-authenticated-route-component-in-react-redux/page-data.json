{"componentChunkName":"component---src-templates-article-page-js","path":"/blog/writing-authenticated-route-component-in-react-redux/","webpackCompilationHash":"0aef3b7d25e0eca4e3b9","result":{"data":{"markdownRemark":{"id":"99574911-1f31-55b5-9566-798c4608d6d0","html":"<p>How to write an Authenticated Route component which will redirect to Sign In Page if user isn't authenticated and once authentication is complete, it'll redirect them back to the same page, this is a problem most new React developers face. Today we learn to do just that.</p>\n<p>But before we begin, lets clear out some assumptions:</p>\n<ul>\n<li>This is not a beginner react-redux authentication tutorial, we assume you already have authentication mechanism set up.</li>\n<li>The Redux association is just to get the \"authenticated\"(bool) state, and you can use any state management you like.</li>\n<li>We are using React Router v4</li>\n<li>You may need to modify it according to your project.</li>\n</ul>\n<p>Now that, that's out of the way lets begin by creating the most important part, the <code>AuthenticatedRoute</code> component.</p>\n<h2>Creating AuthenticatedRoute Component</h2>\n<p><code>AuthenticatedRoute</code> component is a component which basically takes the props of <code>Route</code> and an additional boolean prop, <code>authenticated</code>, which determines if the Component is to be rendered or the user needs to be redirected.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Route<span class=\"token punctuation\">,</span> Redirect<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-router-dom\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">AuthenticatedRoute</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n                                               component<span class=\"token punctuation\">:</span> Component<span class=\"token punctuation\">,</span>\n                                               authenticated<span class=\"token punctuation\">,</span>\n                                               <span class=\"token operator\">...</span>rest\n                                           <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>Route\n            <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span>\n            render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">props</span> <span class=\"token operator\">=></span>\n                authenticated <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>\n                    <span class=\"token operator\">&lt;</span>Component <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>\n                    <span class=\"token operator\">&lt;</span>Redirect to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token string\">`/signin?redirectTo=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>props<span class=\"token punctuation\">.</span>match<span class=\"token punctuation\">.</span>path<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                <span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>It also stores the actual path as a parameter in the signin path <code>/signin?redirectTo=&#x3C;path></code> so that when the user signs in it'll redirect to that path.</p>\n<h2>Redirecting to the URL Param after Sign In</h2>\n<p>To redirect to the param that we set, we need to first edit the <code>signinUser(username, password)</code> action, by adding a third argument, redirect.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">signinUser</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> redirect <span class=\"token operator\">=</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n<span class=\"token comment\">// Authentication Logic</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>we set a default value for the third argument, so that in case no value is provided it'll redirect to home page. Now for the actual redirection.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">signinUser</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> redirect <span class=\"token operator\">=</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dispatch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>authRequest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\n                <span class=\"token operator\">...</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">authSuccess</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">// Redirect</span>\n                window<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> redirect<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">authFailure</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Parsing the URL Parameter</h2>\n<p>To get the <code>redirectTo</code> param's value from<code>/signin?redirectTo=&#x3C;path></code>, we need to install a package called <code>query-string</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> query-string</code></pre></div>\n<p>or</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> query-string --save</code></pre></div>\n<p>now in our Sign In Container, in the function that handles Sign In request, we access the URL param and pass it to <code>signinUser</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token keyword\">import</span> queryString <span class=\"token keyword\">from</span> <span class=\"token string\">'query-string'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">SignInContainer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">handleSignIn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> redirectTo <span class=\"token operator\">=</span> queryString<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>redirectTo<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>actions<span class=\"token punctuation\">.</span><span class=\"token function\">signinUser</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">,</span> redirectTo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Using AuthenticatedRoute in our Router</h2>\n<p>Now it's time to use the AuthenticatedRoute Component, it's very easy to do and works exactly like Route from react-router-dom. It only takes one extra parameter, <code>authenticated</code>, which is a boolean that determines if the user is authenticated or not.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token keyword\">import</span> AuthenticatedRoute <span class=\"token keyword\">from</span> <span class=\"token string\">'./component/AuthenticatedRoute'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">configureStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>sessionReducer<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>session<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>authenticated<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>Provider store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>Router<span class=\"token operator\">></span>\n                    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span>Switch<span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">'/signin'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>SignInPage<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span>AuthenticatedRoute exact path<span class=\"token operator\">=</span><span class=\"token string\">'/'</span> \n                                                component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>HomePage<span class=\"token punctuation\">}</span>\n                                                authenticate<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>authenticated<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                            <span class=\"token operator\">...</span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Switch<span class=\"token operator\">></span>\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And that's it! We're all set.</p>","fields":{"slug":"/blog/writing-authenticated-route-component-in-react-redux/"},"frontmatter":{"date":"June 02, 2018","title":"Writing Authenticated Route Component in React Redux","cover":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABSF7xQYCP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECEQMSIkH/2gAIAQEAAQUClDvSy0ezyNo//8QAFhEBAQEAAAAAAAAAAAAAAAAAABEh/9oACAEDAQE/AcV//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BR//EABsQAAICAwEAAAAAAAAAAAAAAAABETEQEjJB/9oACAEBAAY/AulDJ8Kks1pY/8QAHRABAAIABwAAAAAAAAAAAAAAAQARECFBUWGBsf/aAAgBAQABPyGoJ4UXcJ30la5ed1GwimVsGwYf/9oADAMBAAIAAwAAABDIz//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8Qumyj/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPxCO4Qf/xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUFRcf/aAAgBAQABPxDGgC2qnyBGRlhznW9saAxbWh8DyEgGZK4Dz2fYCnM//9k=","aspectRatio":1.5307629204265791,"src":"/static/3d12ef6d61dd3d3719d544040a65d4a6/1511b/react_redux_authenticated_routes.jpg","srcSet":"/static/3d12ef6d61dd3d3719d544040a65d4a6/79e64/react_redux_authenticated_routes.jpg 269w,\n/static/3d12ef6d61dd3d3719d544040a65d4a6/b1729/react_redux_authenticated_routes.jpg 538w,\n/static/3d12ef6d61dd3d3719d544040a65d4a6/1511b/react_redux_authenticated_routes.jpg 1075w,\n/static/3d12ef6d61dd3d3719d544040a65d4a6/57d19/react_redux_authenticated_routes.jpg 1613w,\n/static/3d12ef6d61dd3d3719d544040a65d4a6/ede7d/react_redux_authenticated_routes.jpg 2150w,\n/static/3d12ef6d61dd3d3719d544040a65d4a6/eeb96/react_redux_authenticated_routes.jpg 5598w","sizes":"(max-width: 1075px) 100vw, 1075px"}},"publicURL":"/static/react_redux_authenticated_routes-3d12ef6d61dd3d3719d544040a65d4a6.jpg"},"meta_title":"Writing Authenticated Route Component in React Redux","meta_description":"Writing Authenticated Routes which will redirect to signin page if the user is not authenticated and once signed in it'll redirect back to the same page.","tags":["ReactJS","Redux","ReactRouter","Authentication"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"99574911-1f31-55b5-9566-798c4608d6d0"}}}