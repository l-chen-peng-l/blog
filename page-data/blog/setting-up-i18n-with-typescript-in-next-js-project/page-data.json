{"componentChunkName":"component---src-templates-article-page-js","path":"/blog/setting-up-i18n-with-typescript-in-next-js-project/","webpackCompilationHash":"43e76ece0bcbc56bcb42","result":{"data":{"markdownRemark":{"id":"ae5266a4-778f-5d51-bc26-8bdfc53a4b96","html":"<p>As I was starting a new <a href=\"https://nextjs.org\">NextJS</a> project, I planned to do it in <a href=\"https://www.typescriptlang.org\">TypeScript</a>. Since I don't know TypeScript, my initial plan was to learn as I go. Comes the time I had to set up i18n using <a href=\"https://github.com/isaachinman/next-i18next\"><code>next-i18next</code></a> plugin, and it was a bit problematic as there was no example for it on the official <a href=\"https://github.com/isaachinman/next-i18next\"><code>next-i18next</code></a> repository. After I successfully learnt how to do it, I did make a PR for typescript example on the original repo but this is incase it doesn't get accepted.</p>\n<p>Setting up <a href=\"https://github.com/isaachinman/next-i18next\">next-i18next</a> in a TS Next app, has 3 parts:</p>\n<ul>\n<li>Setting Up TypeScript Next App</li>\n<li>Adding Custom Server</li>\n<li>Implementing <code>next-i18next</code></li>\n</ul>\n<p>Today we'll set up a simple Next app which will have two pages and an option to change language.</p>\n<h2>Setting Up TypeScript Next App</h2>\n<p>We'll start from a blank folder simple-typescript-i18n which we initialise with</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> init</code></pre></div>\n<p>Then we add the following dependencies</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @zeit/next-typescript next react react-dom</code></pre></div>\n<p>we'll also need some dev dependencies, lets add them</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> @types/next @types/react @types/react-dom typescript --dev</code></pre></div>\n<p>Now we add our two pages</p>\n<p><code>pages/index.tsx</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> Link <span class=\"token keyword\">from</span> <span class=\"token string\">'next/link'</span>\n\n<span class=\"token keyword\">const</span> HomePage<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>FunctionComponent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello<span class=\"token punctuation\">,</span> World<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link href<span class=\"token operator\">=</span><span class=\"token string\">'/second-page'</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>button <span class=\"token keyword\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'button'</span><span class=\"token operator\">></span>Goto Second Page<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HomePage</code></pre></div>\n<p>and</p>\n<p><code>pages/second-page.tsx</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> Link <span class=\"token keyword\">from</span> <span class=\"token string\">'next/link'</span>\n\n<span class=\"token keyword\">const</span> SecondPage<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>FunctionComponent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Welcome To Second Page<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link href<span class=\"token operator\">=</span><span class=\"token string\">'/'</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>button <span class=\"token keyword\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'button'</span><span class=\"token operator\">></span>Go Back<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> SecondPage</code></pre></div>\n<p>Then we create the following files in the root folder</p>\n<p><code>.babelrc</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"presets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"next/babel\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"@zeit/next-typescript/babel\"</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code>next.config.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">const withTypescript = require('@zeit/next-typescript')\n\nmodule.exports = withTypescript()</code></pre></div>\n<p><code>tsconfig.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compileOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"preserve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"allowJs\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"allowSyntheticDefaultImports\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedParameters\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"removeComments\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"preserveConstEnums\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"skipLibCheck\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"baseUrl\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\".\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"typeRoots\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"./node_modules/@types\"</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"es2015\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"es2016\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>to begin our project all we need to do is set up scripts in <code>package.json</code>, add the following lines to your <code>package.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next build\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next start\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type-check\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tsc\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Go ahead and give it a run to check if everything is okay</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> dev</code></pre></div>\n<p>visit <a href=\"http://localhost:3000\">http://localhost:3000</a> from your browser.</p>\n<h2>Adding Custom Server</h2>\n<p>To add next-i18next it's necessary to have a custom server running, for that we'll need to add the following package</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> express</code></pre></div>\n<p>and</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> nodemon ts-node --dev</code></pre></div>\n<p>after doing that we need to create our custom server, in the root directory create a folder called server, in that, create a file called <code>index.ts</code></p>\n<p><code>server/index.ts</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">3000</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dev<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'production'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> handle <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// handle nextjs routing</span>\n  server<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">await</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`üöÄ Ready on http://localhost:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// eslint-disable-line no-console</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>and then a <code>tsconfig.server.json</code> file in the root directory</p>\n<p><code>tsconfig.server.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./tsconfig.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\".build\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es2017\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"es2017\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"next.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"server/**/*.ts\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>now all we need to do some changes in our npm scripts, refactor the following lines in <code>package.json</code> </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"nodemon --exec ts-node --project tsconfig.server.json server\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next build &amp;&amp; tsc --project tsconfig.server.json\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"NODE_ENV=production node .build/server\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type-check\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tsc\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>give it a spin, to see if everything is working all right.</p>\n<h2>Implementing next-i18next</h2>\n<p>All that's left now is to add i18next, to do that we begin by adding the following package</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> next-i18next</code></pre></div>\n<p>next we add a file <code>i18n.ts</code> to our root</p>\n<p><code>i18n.ts</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> NextI18Next <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next-i18next/dist/commonjs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">default</span>\n\n<span class=\"token keyword\">module</span><span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NextI18Next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  defaultLanguage<span class=\"token punctuation\">:</span> <span class=\"token string\">'en'</span><span class=\"token punctuation\">,</span>\n  otherLanguages<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'hi'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  localeSubpaths<span class=\"token punctuation\">:</span> <span class=\"token string\">'foreign'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// locale subpaths for url could be none, foreign or all</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>now we add the i18next middleware to our server as well i18n configuration</p>\n<p><code>server/index.ts</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> nextI18NextMiddleware <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next-i18next/middleware'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> nextI18next <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../i18n'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">3000</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dev<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">!==</span> <span class=\"token string\">'production'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> handle <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// use the next-i18next middleware with our i18n configuration</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    server<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">nextI18NextMiddleware</span><span class=\"token punctuation\">(</span>nextI18next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// handle nextjs routing</span>\n  server<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">await</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`üöÄ Ready on http://localhost:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// eslint-disable-line no-console</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>next we add <code>appWithTranslation</code> HOC to a custom <code>_app.tsx</code></p>\n<p><code>pages/_app.tsx</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> App<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Container <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/app'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> appWithTranslation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../i18n'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyApp</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">App</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> pageProps <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Container<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Component <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>pageProps<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Container<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">appWithTranslation</span><span class=\"token punctuation\">(</span>MyApp<span class=\"token punctuation\">)</span></code></pre></div>\n<p>next we add some translations, to do that we need to create a folder called static in our root, then add a folder called locales in static then add folders named with language codes in locales and add common.json files to them. In our case we'll be adding english as default and hindi as the other language</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.\n‚îú‚îÄ‚îÄ pages\n‚îÇ   ‚îú-- _app.tsx\n‚îÇ   ‚îú-- index.tsx\n‚îÇ   ‚îî-- second-page.tsx\n‚îú‚îÄ‚îÄ static\n‚îÇ   ‚îî-- locales\n‚îÇ       ‚îú-- en\n‚îÇ       ‚îÇ   ‚îî-- common.json\n‚îÇ       ‚îî-- hi\n‚îÇ           ‚îî-- common.json\n‚îú-- server\n‚îÇ   ‚îî-- index.ts\n‚îú-- .babelrc\n‚îú-- i18n.ts\n‚îú-- next.config.js\n‚îú-- package.json\n‚îú-- tsconfig.json\n‚îú-- tsconfig.server.json\n‚îî‚îÄ‚îÄ yarn.lock</code></pre></div>\n<p>Add translations to <code>common.json</code> files</p>\n<p><code>static/locales/en/common.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hello-world\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Hello, World!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"goto-second-page\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Goto Second Page\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"change-language\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Change Language\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"welcome\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Welcome To Second Page\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"go-back\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Go Back\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code>static/locales/hi/common.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hello-world\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§µ‡§ø‡§∂‡•ç‡§µ!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"goto-second-page\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"‡§¶‡•Ç‡§∏‡§∞‡•á ‡§™‡•á‡§ú ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"change-language\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"‡§≠‡§æ‡§∑‡§æ ‡§¨‡§¶‡§≤‡•á‡§Ç\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"welcome\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"‡§¶‡•Ç‡§∏‡§∞‡•á ‡§™‡•á‡§ú ‡§™‡§∞ ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"go-back\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>then we refactor our two pages to include translation HOC, namespaces and translation function, also add a button to change language.</p>\n<p><code>pages/index.tsx</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> i18n<span class=\"token punctuation\">,</span> Link<span class=\"token punctuation\">,</span> withNamespaces <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../i18n'</span> <span class=\"token comment\">// We replace next/link with the one provide by next-i18next, this helps with locale subpaths</span>\n\n<span class=\"token keyword\">const</span> HomePage<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>FunctionComponent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> t <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hello-world'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button <span class=\"token keyword\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'button'</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> i18n<span class=\"token punctuation\">.</span><span class=\"token function\">changeLanguage</span><span class=\"token punctuation\">(</span>i18n<span class=\"token punctuation\">.</span>language <span class=\"token operator\">===</span> <span class=\"token string\">'en'</span> <span class=\"token operator\">?</span> <span class=\"token string\">'hi'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'en'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change-language'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link href<span class=\"token operator\">=</span><span class=\"token string\">'/second-page'</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>button <span class=\"token keyword\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'button'</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'goto-second-page'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\nHomePage<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getInitialProps</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  namespacesRequired<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withNamespaces</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>HomePage<span class=\"token punctuation\">)</span></code></pre></div>\n<p>and </p>\n<p><code>pages/second-page.tsx</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withNamespaces<span class=\"token punctuation\">,</span> Link <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../i18n'</span>\n\n<span class=\"token keyword\">const</span> SecondPage<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>FunctionComponent<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> t <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'welcome'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link href<span class=\"token operator\">=</span><span class=\"token string\">'/'</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>button <span class=\"token keyword\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'button'</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'go-back'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withNamespaces</span><span class=\"token punctuation\">(</span><span class=\"token string\">'common'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>SecondPage<span class=\"token punctuation\">)</span></code></pre></div>\n<p>now all we have to do is make minor changes to our <code>tsconfig.server.json</code> to include our i18n compiled file as it is in our build folder</p>\n<p><code>tsconfig.server.json</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./tsconfig.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\".build\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es2017\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"es2017\"</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"i18n.ts\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"next.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"server/**/*.ts\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That's it we are done now you can go ahead and try to run, to see if everything is working.</p>\n<p>And that's how you set up <a href=\"https://github.com/isaachinman/next-i18next\">next-i18next</a> with typescript in <a href=\"https://nextjs.org\">Next JS</a> app.</p>","fields":{"slug":"/blog/setting-up-i18n-with-typescript-in-next-js-project/"},"frontmatter":{"date":"March 10, 2019","title":"Setting up i18n with TypeScript in Next JS Project ","cover":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEBf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAwT/2gAMAwEAAhADEAAAAY6My4TEUyf/xAAdEAABBAIDAAAAAAAAAAAAAAABAAIDEhETISMy/9oACAEBAAEFAhiJw4h01XpNPZK83//EABcRAAMBAAAAAAAAAAAAAAAAAAABIUH/2gAIAQMBAT8Bxsp//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/ARV//8QAHBAAAQQDAQAAAAAAAAAAAAAAAAECEUEQITFx/9oACAEBAAY/Ap6OcixXpBsRtY//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhYUGR/9oACAEBAAE/IUauC6htgXQ9xHC21sVArkVb18lpP//aAAwDAQACAAMAAAAQV/8A/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAQf/aAAgBAwEBPxCEvM003//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAgEBPxDQGy//xAAcEAACAwEAAwAAAAAAAAAAAAABEQAhMVFBYXH/2gAIAQEAAT8QzUV2thPnmLpIAAWBRPLiilB+jstwGLWnCe8QitKtn//Z","aspectRatio":1.5,"src":"/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/1511b/i18n-typescript-nextjs.jpg","srcSet":"/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/79e64/i18n-typescript-nextjs.jpg 269w,\n/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/b1729/i18n-typescript-nextjs.jpg 538w,\n/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/1511b/i18n-typescript-nextjs.jpg 1075w,\n/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/57d19/i18n-typescript-nextjs.jpg 1613w,\n/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/ede7d/i18n-typescript-nextjs.jpg 2150w,\n/blog/static/a9bb745c25d7ccfbb4bd08cea2090b38/17d28/i18n-typescript-nextjs.jpg 6000w","sizes":"(max-width: 1075px) 100vw, 1075px"}},"publicURL":"/blog/static/i18n-typescript-nextjs-a9bb745c25d7ccfbb4bd08cea2090b38.jpg"},"meta_title":"Setting up i18n with Typescript in Next JS Project","meta_description":"Leverage the power of TypeScript with Next JS and make your project i18n ready. Use the plugin next-i18next with your TypeScript Next JS project.","tags":["i18n","NextJS","TypeScript","SSR"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"ae5266a4-778f-5d51-bc26-8bdfc53a4b96"}}}