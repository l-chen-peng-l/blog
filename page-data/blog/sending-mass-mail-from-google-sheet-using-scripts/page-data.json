{"componentChunkName":"component---src-templates-article-page-js","path":"/blog/sending-mass-mail-from-google-sheet-using-scripts/","webpackCompilationHash":"0aef3b7d25e0eca4e3b9","result":{"data":{"markdownRemark":{"id":"7365c3b9-828a-588b-96ba-beba9feb3f43","html":"<p>Ever find yourself with a big spreadsheet full of names and emails and you have to send personalized emails to all of them? We did. We had a spreadsheet full of candidates for hiring and: </p>\n<ul>\n<li>We had to first send them a mail asking if they are interested.</li>\n<li>If they replied positively we had to send them an assignment.</li>\n<li>If they hadn't replied with the completed assignment, we had to send them reminder mail.</li>\n</ul>\n<p>So what we did first was, add three columns:</p>\n<ul>\n<li>Send First Email</li>\n<li>Send Assignment</li>\n<li>Send Reminder</li>\n</ul>\n<p>These columns containing the word \"Send\" if the candidate has to be mailed, and \"Sent\" once the mail has been sent. So basically our script goes through, the sheet, picks up the candidate name, and email, uses name variable to create a personalized message, send it to their email(if the Send First Email contains the keyword \"Send\") and after sending replaces the keyword with \"Sent\".</p>\n<h2>Step One: Structure of Our Sheet</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 631px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/03e263e78507f51ce9d0d8e5ce0835c0/eef7a/sheet_structure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.946117274167987%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnUlEQVQI1xWN6RKCIBhFff9nq0lzZVxDWUwTUgKilL7+nZl7z5yAEsI5F0JwxsbxrrZtmiZK6faHWUpprVVKreuqtQaAQ9dUeRo3dRm0TbssggwDKor5sWj9QgXCN+ycgwljDNpTSrCMMcexv91+CstzWHWDCBhj3nvo13UDYI1BCEENmPRDlmbRJbqG1zROMO794T/fI8k7Pivj/A/6qKSP0Px03QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"google sheet sturcture\"\n        title=\"google sheet sturcture\"\n        src=\"/static/03e263e78507f51ce9d0d8e5ce0835c0/eef7a/sheet_structure.png\"\n        srcset=\"/static/03e263e78507f51ce9d0d8e5ce0835c0/c5a17/sheet_structure.png 512w,\n/static/03e263e78507f51ce9d0d8e5ce0835c0/eef7a/sheet_structure.png 631w\"\n        sizes=\"(max-width: 631px) 100vw, 631px\"\n      />\n  </a>\n    </span></p>\n<p>This is our example table, for the customized message we'll pick up, the first name from <code>column B</code>, the last name from <code>column C</code> etc. You can add more details accordingly.</p>\n<h2>Step Two: Script for Mass Mail</h2>\n<p>Google Script uses plain JavaScript with some built-in APIs. First, we write the function that'll send the mail. To Write the Script click on <code>Tools > Script Editor</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">sendMassMail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// Get Active Sheet</span>\n  <span class=\"token keyword\">var</span> sheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n  <span class=\"token comment\">// Sender Name will Appear to the Recipient</span>\n  <span class=\"token keyword\">var</span> senderName <span class=\"token operator\">=</span> <span class=\"token string\">\"Vaibhav | The Leaky Cauldron Blog\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Get all Data.</span>\n  <span class=\"token keyword\">var</span> dataRange <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getDataRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n  <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> dataRange<span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n  <span class=\"token keyword\">var</span> count <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Parse Through Data</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    count <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> rowData <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \n\n    <span class=\"token comment\">// Array Starts with 0, eg. - column B is 1</span>\n    <span class=\"token keyword\">var</span> first_name <span class=\"token operator\">=</span> rowData<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \n    <span class=\"token keyword\">var</span> last_name <span class=\"token operator\">=</span> rowData<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> emailAddress <span class=\"token operator\">=</span> rowData<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \n    <span class=\"token keyword\">var</span> confirmSend <span class=\"token operator\">=</span> rowData<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> \n\n    <span class=\"token comment\">// Set a Custom Subject</span>\n    <span class=\"token keyword\">var</span> subject <span class=\"token operator\">=</span> first_name <span class=\"token operator\">+</span> <span class=\"token string\">' | Graphic Designer Role at The Leaky Cauldron Blog'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Verify if the mail has to be sent</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>confirmSend <span class=\"token operator\">===</span> <span class=\"token string\">\"Send\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span> \n\n        <span class=\"token comment\">// Use MailApp API to send Email.</span>\n        MailApp<span class=\"token punctuation\">.</span><span class=\"token function\">sendEmail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> \n          to<span class=\"token punctuation\">:</span> emailAddress<span class=\"token punctuation\">,</span> \n          subject<span class=\"token punctuation\">:</span> subject<span class=\"token punctuation\">,</span> \n          <span class=\"token comment\">// Write Custom HTML Message</span>\n          htmlBody<span class=\"token punctuation\">:</span> <span class=\"token string\">'&lt;div>Hi '</span> <span class=\"token operator\">+</span> first_name <span class=\"token operator\">+</span> last_name <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/div>'</span><span class=\"token punctuation\">,</span> \n          name<span class=\"token punctuation\">:</span> senderName \n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n        <span class=\"token comment\">// Set the value of Mail Status to Sent if Sent.</span>\n        <span class=\"token comment\">// getRange(row, column). column starts from 1.</span>\n        sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sent\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Log if the Mail was sent successfully</span>\n        Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Email: %s\"</span><span class=\"token punctuation\">,</span> emailAddress<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n\n        <span class=\"token comment\">// Set the value of Mail Status to Failed if Failed.</span>\n        sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Log if there was some error</span>\n        Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\n      <span class=\"token punctuation\">}</span> \n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> \n      <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span> \n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Don't forget to Save the Project.</p>\n<h2>Step Three: Add the Function To Main Menu</h2>\n<p>Below the <code>sendMassMail()</code> write a function called <code>onOpen()</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">onOpen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> sheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> entries <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// Set a Name for Function</span>\n    name <span class=\"token punctuation\">:</span> <span class=\"token string\">\"Send Mass Mail\"</span><span class=\"token punctuation\">,</span>\n    functionName <span class=\"token punctuation\">:</span> <span class=\"token string\">\"sendMassMail\"</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Add a Menu and name it</span>\n  sheet<span class=\"token punctuation\">.</span><span class=\"token function\">addMenu</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Email\"</span><span class=\"token punctuation\">,</span> entries<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Save and reload the sheet, you'll see a menu called <code>Email</code>, and within it, an option called <code>Send Mass Mail</code>. </p>\n<p>That's it just click on the option to run the script and send mass mail. One more, thing you'll have to approve the script to use your Gmail.</p>\n<p>Link To Example Sheet - <a href=\"https://docs.google.com/spreadsheets/d/1OeRL8bFaAYuwAQXdy_wV1WKmGap_gcQ3jFOzrbKVEuo/edit?usp=sharing\">Mass Mail</a></p>","fields":{"slug":"/blog/sending-mass-mail-from-google-sheet-using-scripts/"},"frontmatter":{"date":"June 04, 2018","title":"Sending Mass Mail from Google Sheet using Scripts","cover":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwABBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAekxIK2Sf//EABUQAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEBAAEFAil//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFhABAQEAAAAAAAAAAAAAAAAAAAEx/9oACAEBAAE/IWJiER//2gAMAwEAAgADAAAAEN8f/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QZ//EABcRAAMBAAAAAAAAAAAAAAAAAAEQEUH/2gAIAQIBAT8Qh1f/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhQTH/2gAIAQEAAT8QTUNeDvgq7TLGc9P/2Q==","aspectRatio":1.49800796812749,"src":"/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/1511b/mass_mail_google_script.jpg","srcSet":"/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/79e64/mass_mail_google_script.jpg 269w,\n/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/b1729/mass_mail_google_script.jpg 538w,\n/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/1511b/mass_mail_google_script.jpg 1075w,\n/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/57d19/mass_mail_google_script.jpg 1613w,\n/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/ede7d/mass_mail_google_script.jpg 2150w,\n/static/d7128c3ea9dcf3e717f8bd2304d3b2cf/595d8/mass_mail_google_script.jpg 6016w","sizes":"(max-width: 1075px) 100vw, 1075px"}},"publicURL":"/static/mass_mail_google_script-d7128c3ea9dcf3e717f8bd2304d3b2cf.jpg"},"meta_title":"Sending Mass Mail from Google Sheet using Scripts","meta_description":"Leverage the power of Google Script to run email campaigns, right from your Google Sheet.","tags":["GoogleSheet","GoogleScript","Email"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"7365c3b9-828a-588b-96ba-beba9feb3f43"}}}